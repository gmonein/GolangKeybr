<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>A static page</title>
  </head>
<body>
  <div id='citation' class='citation'>
  </div>
  <input type="textarea" id="letterInput" maxlength="1">
</body>
<style>
  .citation {
    width: 80%;
    text-align: center;
    background: #f0e68c;
  }
  .letter {
    min-width: 5px;
    min-height: 14px;
    padding-right: 2px;
    display: inline-block;
  }
  .space:after{
    content: '-';
    opacity: 0%;
  }
  .success {
    color: green;
  }
  .fail {
    color: red;
  }
  .index {
    background-color: grey;
  }
</style>
<script>
   let letterInput = document.getElementById('letterInput')
   fetch("/citation")
      .then(response => response.text())
      .then((response) => {
        let div = document.getElementById('citation')
        let explode = [...response]
        let index = -1
        div.innerHTML = explode.map( letter => {
          if (letter == "\n") {
            return `<div>${letter}</div>`
          } else if (letter == " ") {
            index += 1
            return `<div index=${index} class='letter space'> </div>`
          } else {
            index += 1
            return `<div index=${index} class='letter'>${letter}</div>`
          }
        }).join('')
        letterInput.index = 0
        document.querySelector(`div.letter[index='0']`).classList.add('index')
      })
      .catch(err => console.log(err))
letterInput.oninput = e => {
  let div = document.querySelector(`div.letter[index='${letterInput.index}']`)

  if (div.innerHTML == e.target.value) {
    div.classList.add('success')
    div.classList.remove('index')
    letterInput.index += 1
    document.querySelector(`div.letter[index='${letterInput.index}']`).classList.add('index')
  }
  else {
    div.classList.add('fail')
  }
  e.target.value = ''
  e.preventDefault()
}
</script>
</html>
